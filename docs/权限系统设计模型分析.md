
#越权访问
权限系统设计的目的是为了将系统使用者对系统的操作约束在一个合法的范围内，系统的使用者不一定是人，也可能是另外一个系统，如果操作不在合法范围内，就会发生越权访问行为，越权访问会造成非常严重的安全问题，被OWASP列为Web应用十大安全隐患的第二名。
越权访问主要分为水平越权和垂直越权两种。
垂直越权是一种权限非法提升的行为，比如说现在有个系统，普通用户的令牌直接跳到管理员的页面去做一些不可描述的事情
水平越权主要是因为服务端没有判断数据的归属所造成的越权行为，用户1令牌获取到了只属于用户2的信息
站在服务端设计的角度我们可以很容易看出来，垂直越权指的是访问了不该访问的API，而水平越权则是访问到了不该访问的数据，这一点很重要。
#鉴权
鉴权指的是在进行一个操作的时候，需要权限系统先去判断用户是否具有进行这个操作的权限，在某些复杂场景之下还会包括对请求数据的归属权的校验。
在讲模型之前，我们首先要明白权限管控的真正含义是：判断请求者在某些条件下是否对请求数据具备某个操作（API） 的能力。
注意四个词，1、请求者，2、某些条件，3、请求数据，4、操作（API）
请求者一般来说是用户，也有可能是某个系统，亦或者是一段代码；
某些条件，有可能是环境条件，比如说某个API只允许10.122.131.1这个ip来访问，或者说只能在晚上访问，或者说只能在周内访问此类；
请求数据即本次请求要求操作的数据，比如说查看id为1的用户的具体信息；
鉴权（api） 即对这个数据做的事情，是查看还是还是修改，注意修改其实也包含了删除。
#模型
1、RBAC（Role Based Access Control）
RBAC的能力可以用这么一句话来描述：一个用户通过和角色绑定(角色（Role） 的本质其实就是一系列API操作的聚合),具备了一些对数据操作的能力，往简单的说就是一个用户有了一些对数据操作的能力。
其实之所以在中间加一层角色，是为了增加安全性和效率，而且后续扩展上也会提升不少。
但是，如果在复杂的权限管控场景中，RBAC显得有些力不从心，比如说：
用户在晚上不能访问这个系统，但是白天可以
用户只能在内网对订单具备修改权限，而在外网就只有查看权限
用户对2021-03-19日之前创建的订单有操作权限
用户只能在深圳进行查看订单，而去了国外就不可以
用户在公司内部可以访问所有数据，但是在外部就只能访问公开数据

2、ABAC（Attribute Based Access Control）
ABAC 翻译过来意思是基于属性的权限访问控制,也仅仅擅长于管控垂直越权，即使ABAC具备一定的管控水平越权的能力，也不要妄想可以用它来管控所有的水平越权。
ABAC设计的目的是为了能够满足控制请求者在某些条件下是否对请求数据具备某个操作（API） 的能力，目前来看，ABAC还暂时没有什么标准建模（policy不是由实体组成），一般都是policy的语法设计，这个指的就是用一个json或者一个xml来描述一个policy ，这个policy会和用户或者其他实体绑定，然后这个用户或者是实体就具备了在某些条件下对某些数据的操作能力。
为什么ABAC没有标准建模呢？作者的经验是认为，ABAC主要是语法设计，因此会非常灵活，这种非常灵活的关系不适合用模型和模型
之间的约束关系来表示，因此目前经典的设计都是用xml或者json来表示一个policy。
{
    "effect":"Allow",
    "actions":[
        "getUser",
        "updateUser",
        "get*"
    ],
    "resources":[
        "contextField:contextValue:resourceField:resourceValue"
    ],
    "condition":[
        {
            "operation-name":{
                "condition-key":[
                    "condition value"
                ]
            }
        }
    ]
}




